export default{onSetup(){const t=this.newFeature({type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[]]}});var e;return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.setActionableState({trash:!0}),e=this,setTimeout(()=>{const{map:t}=e,a=t&&t.doubleClickZoom;t&&a&&a.disable()},0),{rectangle:t}},onClick(t,e){return t.startPoint&&t.startPoint[0]!==e.lngLat.lng&&t.startPoint[1]!==e.lngLat.lat?this.onRectangleDone(t,e):this.onRectangleStart(t,e)},onDrag(t,e){return e.preventDefault(),this.onRectangleDraw(t,e)},onKeyUp:function(t,e){if(27===e.keyCode)return this.changeMode(this.drawConfig.defaultMode)},onMouseUp(t,e){return e.preventDefault(),this.onClick(t,e)},onMouseDown(t,e){return e.preventDefault(),this.onClick(t,e)},onMouseMove:function(t,e){return this.onRectangleDraw(t,e)},onRectangleStart(t,e){const a=[e.lngLat.lng,e.lngLat.lat];t.startPoint=a,t.rectangle.updateCoordinate("0.0",t.startPoint[0],t.startPoint[1])},onRectangleDraw(t,e){t.startPoint&&(t.rectangle.updateCoordinate("0.1",e.lngLat.lng,t.startPoint[1]),t.rectangle.updateCoordinate("0.2",e.lngLat.lng,e.lngLat.lat),t.rectangle.updateCoordinate("0.3",t.startPoint[0],e.lngLat.lat),t.rectangle.updateCoordinate("0.4",t.startPoint[0],t.startPoint[1]))},onRectangleDone(t,e){return t.endPoint=[e.lngLat.lng,e.lngLat.lat],this.updateUIClasses({mouse:"pointer"}),this.changeMode(this.drawConfig.defaultMode,{featuresId:t.rectangle.id}),this.map._container.querySelector("button.mapbox-gl-draw_rectangle").classList.remove("active"),this.onStop(t)},onTap:function(t,e){t.startPoint&&this.onMouseMove(t,e),this.onClick(t,e)},onStop(t){var e;e=this,setTimeout(()=>{const t=e._ctx&&e._ctx.store,a=e.map&&e.map;(a||t.getInitialValue)&&t.getInitialConfigValue("doubleClickZoom")&&a.doubleClickZoom.enable()},0),this.updateUIClasses({mouse:"none"}),this.getFeature(t.rectangle.id)&&(t.rectangle.removeCoordinate("0.4"),t.rectangle.isValid()?this.map.fire("draw.create",{features:[t.rectangle.toGeoJSON()]}):(this.deleteFeature([t.rectangle.id],{silent:!0}),this.changeMode(this.drawConfig.defaultMode,{},{silent:!0})))},onTrash(t){this.deleteFeature([t.rectangle.id],{silent:!0}),this.changeMode(this.drawConfig.defaultMode)},toDisplayFeatures(t,e,a){const n=e.properties.id===t.rectangle.id;e.properties.active=n.toString(),n?t.startPoint&&a(e):a(e)}};
